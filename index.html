<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ’– MEGI ðŸ’–</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #000;
    overflow: hidden;
    width: 100vw;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Georgia', 'Times New Roman', serif;
  }

  .heart-container {
    position: relative;
    width: 75vmin;
    height: 75vmin;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2;
    filter: drop-shadow(0 0 40px rgba(255, 0, 80, 0.5))
            drop-shadow(0 0 80px rgba(255, 0, 80, 0.25));
    animation: heartbeat 1.4s ease-in-out infinite;
    will-change: transform;
  }

  /* Simplified shadows on mobile for better performance */
  @media (max-width: 900px), (hover: none) {
    .heart-container {
      filter: drop-shadow(0 0 30px rgba(255, 0, 80, 0.4));
    }
    .megi-text {
      text-shadow:
        0 0 10px rgba(255, 255, 255, 0.8),
        0 0 30px rgba(255, 100, 150, 0.5);
    }
  }

  @keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    15% { transform: scale(1.06); }
    30% { transform: scale(1); }
    45% { transform: scale(1.04); }
    60% { transform: scale(1); }
  }

  .heart-svg {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }

  .heart-gradient-fill {
    fill: url(#heartGradient);
  }

  .megi-text {
    position: relative;
    z-index: 3;
    font-size: 7vmin;
    font-weight: bold;
    color: #fff;
    letter-spacing: 1.2vmin;
    text-shadow:
      0 0 10px rgba(255, 255, 255, 0.8),
      0 0 30px rgba(255, 100, 150, 0.6),
      0 0 60px rgba(255, 50, 100, 0.4);
    animation: glowPulse 2s ease-in-out infinite alternate;
    margin-top: -10%;
    user-select: none;
  }

  @keyframes glowPulse {
    0% {
      text-shadow:
        0 0 10px rgba(255, 255, 255, 0.8),
        0 0 30px rgba(255, 100, 150, 0.6),
        0 0 60px rgba(255, 50, 100, 0.4);
    }
    100% {
      text-shadow:
        0 0 15px rgba(255, 255, 255, 1),
        0 0 40px rgba(255, 100, 150, 0.9),
        0 0 80px rgba(255, 50, 100, 0.6),
        0 0 120px rgba(255, 0, 80, 0.3);
    }
  }

  /* Petals canvas behind the heart */
  #petalsCanvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 1;
    pointer-events: none;
  }

  /* Ambient particles */
  .ambient-particle {
    position: fixed;
    width: 3px;
    height: 3px;
    background: rgba(255, 100, 150, 0.5);
    border-radius: 50%;
    z-index: 0;
    animation: floatUp linear infinite;
    pointer-events: none;
    will-change: transform, opacity;
  }

  @keyframes floatUp {
    0% { transform: translateY(100vh) scale(0); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(-20vh) scale(1); opacity: 0; }
  }
</style>
</head>
<body>

<canvas id="petalsCanvas"></canvas>

<div class="heart-container">
  <svg class="heart-svg" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <radialGradient id="heartGradient" cx="50%" cy="40%" r="60%">
        <stop offset="0%" stop-color="#ff3366" />
        <stop offset="40%" stop-color="#e60045" />
        <stop offset="75%" stop-color="#cc0033" />
        <stop offset="100%" stop-color="#8b0020" />
      </radialGradient>
      <!-- Shine overlay -->
      <radialGradient id="heartShine" cx="35%" cy="30%" r="35%">
        <stop offset="0%" stop-color="rgba(255,255,255,0.35)" />
        <stop offset="100%" stop-color="rgba(255,255,255,0)" />
      </radialGradient>
    </defs>
    <path class="heart-gradient-fill"
      d="M256 448l-30.164-27.211C118.718 322.927 48 258.636 48 179.834 48 114.013 98.636 64 164.5 64c37.5 0 73.572 17.662 91.5 44.384C273.928 81.662 309.998 64 347.5 64 413.364 64 464 114.013 464 179.834c0 78.802-70.718 143.093-177.836 241.07L256 448z"/>
    <path fill="url(#heartShine)"
      d="M256 448l-30.164-27.211C118.718 322.927 48 258.636 48 179.834 48 114.013 98.636 64 164.5 64c37.5 0 73.572 17.662 91.5 44.384C273.928 81.662 309.998 64 347.5 64 413.364 64 464 114.013 464 179.834c0 78.802-70.718 143.093-177.836 241.07L256 448z"/>
  </svg>
  <span class="megi-text">MEGI</span>
</div>

<script>
// ========== PERFORMANCE DETECTION ==========
const isMobile = /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)
  || (navigator.maxTouchPoints > 1 && window.innerWidth < 900);

// ========== PETAL SYSTEM ==========
const canvas = document.getElementById('petalsCanvas');
const ctx = canvas.getContext('2d', { alpha: true });

// Limit resolution on mobile to avoid huge canvases on retina screens
const MAX_DPR = isMobile ? 1 : Math.min(window.devicePixelRatio || 1, 2);

function resize() {
  canvas.width = window.innerWidth * MAX_DPR;
  canvas.height = window.innerHeight * MAX_DPR;
  canvas.style.width = window.innerWidth + 'px';
  canvas.style.height = window.innerHeight + 'px';
  ctx.setTransform(MAX_DPR, 0, 0, MAX_DPR, 0, 0);
}
resize();
let resizeTimeout;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimeout);
  resizeTimeout = setTimeout(resize, 200);
});

// Petal colors: red, white, pink
const petalColors = [
  { base: '#e63946', shadow: '#9b1d25', highlight: '#ff6b6b' },  // red
  { base: '#fff0f3', shadow: '#ddb8bf', highlight: '#ffffff' },  // white
  { base: '#ff85a1', shadow: '#c9556d', highlight: '#ffb3c6' },  // pink
  { base: '#d62839', shadow: '#8a1525', highlight: '#f25c6e' },  // deep red
  { base: '#ffccd5', shadow: '#d4909a', highlight: '#fff0f3' },  // light pink
];

// Pre-render petal sprites to offscreen canvases (avoids creating gradients every frame)
const PETAL_SIZES = isMobile ? [10, 14, 18] : [8, 11, 14, 17, 20];
const petalSprites = [];

function createPetalSprite(size, color) {
  const padding = 4;
  const dim = (size + padding) * 2;
  const offCanvas = document.createElement('canvas');
  offCanvas.width = dim;
  offCanvas.height = dim;
  const offCtx = offCanvas.getContext('2d');

  offCtx.translate(dim / 2, dim / 2);

  const s = size;

  // Draw petal shape
  offCtx.beginPath();
  offCtx.moveTo(0, -s);
  offCtx.bezierCurveTo(s * 0.8, -s * 0.8, s * 0.9, s * 0.2, 0, s);
  offCtx.bezierCurveTo(-s * 0.9, s * 0.2, -s * 0.8, -s * 0.8, 0, -s);
  offCtx.closePath();

  const grad = offCtx.createLinearGradient(-s * 0.5, -s, s * 0.3, s);
  grad.addColorStop(0, color.highlight);
  grad.addColorStop(0.5, color.base);
  grad.addColorStop(1, color.shadow);
  offCtx.fillStyle = grad;
  offCtx.fill();

  // Subtle vein line
  offCtx.beginPath();
  offCtx.moveTo(0, -s * 0.7);
  offCtx.quadraticCurveTo(s * 0.05, 0, 0, s * 0.7);
  offCtx.strokeStyle = color.shadow;
  offCtx.globalAlpha = 0.15;
  offCtx.lineWidth = 0.5;
  offCtx.stroke();

  return { canvas: offCanvas, size: dim };
}

// Build sprite cache
for (const color of petalColors) {
  for (const size of PETAL_SIZES) {
    petalSprites.push(createPetalSprite(size, color));
  }
}

class Petal {
  constructor() {
    this.reset(true);
  }

  reset(initial = false) {
    const w = window.innerWidth;
    const h = window.innerHeight;
    this.x = Math.random() * w;
    this.y = initial ? Math.random() * h : -30;
    this.speedY = 0.6 + Math.random() * 1.5;
    this.speedX = (Math.random() - 0.5) * 0.8;
    this.rotation = Math.random() * Math.PI * 2;
    this.rotationSpeed = (Math.random() - 0.5) * 0.04;
    this.wobbleSpeed = 0.008 + Math.random() * 0.015;
    this.wobbleOffset = Math.random() * Math.PI * 2;
    this.time = initial ? Math.random() * 500 : 0;
    this.opacity = 0.6 + Math.random() * 0.4;
    this.flip = Math.random() * Math.PI * 2;
    this.flipSpeed = 0.01 + Math.random() * 0.03;
    // Pick a pre-rendered sprite
    this.sprite = petalSprites[Math.floor(Math.random() * petalSprites.length)];
  }

  update() {
    this.time++;
    this.y += this.speedY;
    this.x += this.speedX + Math.sin(this.time * this.wobbleSpeed + this.wobbleOffset) * 0.5;
    this.rotation += this.rotationSpeed;
    this.flip += this.flipSpeed;

    const w = window.innerWidth;
    const h = window.innerHeight;
    if (this.y > h + 40 || this.x < -60 || this.x > w + 60) {
      this.reset();
    }
  }

  draw(ctx) {
    const flipFactor = Math.cos(this.flip);
    const absFlip = Math.abs(flipFactor);

    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.rotate(this.rotation);
    ctx.scale(flipFactor, 1);
    ctx.globalAlpha = this.opacity * (0.5 + absFlip * 0.5);

    const sp = this.sprite;
    ctx.drawImage(sp.canvas, -sp.size / 2, -sp.size / 2);

    ctx.restore();
  }
}

// Fewer petals on mobile for smooth performance
const PETAL_COUNT = isMobile ? 35 : 90;
const petals = [];
for (let i = 0; i < PETAL_COUNT; i++) {
  petals.push(new Petal());
}

function animate() {
  ctx.save();
  ctx.setTransform(MAX_DPR, 0, 0, MAX_DPR, 0, 0);
  ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);

  for (const petal of petals) {
    petal.update();
    petal.draw(ctx);
  }

  ctx.restore();
  requestAnimationFrame(animate);
}
animate();

// ========== AMBIENT PARTICLES ==========
function createAmbientParticles() {
  const body = document.body;
  const count = isMobile ? 10 : 25;
  for (let i = 0; i < count; i++) {
    const particle = document.createElement('div');
    particle.className = 'ambient-particle';
    particle.style.left = Math.random() * 100 + 'vw';
    particle.style.animationDuration = (6 + Math.random() * 10) + 's';
    particle.style.animationDelay = Math.random() * 10 + 's';
    particle.style.width = (2 + Math.random() * 3) + 'px';
    particle.style.height = particle.style.width;
    const colors = ['rgba(255,100,150,0.4)', 'rgba(255,50,80,0.3)', 'rgba(255,180,200,0.3)'];
    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
    body.appendChild(particle);
  }
}
createAmbientParticles();
</script>
</body>
</html>
